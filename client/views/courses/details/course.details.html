<template name="courseDetailsPage">
	<div class="container">
		<div class="course-details-column-left">
			{{#if edit}}
				<div class="details-page-component">
					{{> course_edit course}}
				</div>
			{{else}}
				<div class="details-page-component">
					<div class="course-details {{#with course}}{{coursestate}}{{/with}}">
						{{#if editableName}}
							<div class="course-details-title">
								{{>editable editableName}}
							</div>
						{{else}}
							<h2>{{course.name}}</h2>
						{{/if}}
						{{#with course}}
							<div class="course-details-categories">
								{{> courseCategories}}
							</div>
							<div class="course-details-groups">
								{{> courseGroupList}}
							</div>
						{{/with}}
						{{> courseDetailsSubmenu}}
					</div>
					{{#with course}}
						{{#if currentUserMayEdit}}
							<div class="actions">
								<button type="button" class="btn btn-delete js-delete-course-btn">
									<i class="fa fa-trash fa-fw"></i>
									{{mf '_button.delete'}}
								</button>
								<button type="button" class="btn btn-edit js-edit-course-btn">
									<i class="fa fa-edit fa-fw"></i>
									{{mf '_button.edit'}}
								</button>
							</div>
						{{/if}}
					{{/with}}
				</div>
				<div class="details-page-component">
					{{> report}}
				</div>
			{{/if}}
			<!-- GET VIEWPORT SIZE AND ADJUST LAYOUT-->
			{{#if mobileViewport}}
				{{> course_events}}
			{{else}}
				{{> discussion course}}
			{{/if}}
		</div>
		<div class="course-details-column-right">
			{{#unless mobileViewport}}
				{{> course_events}}
			{{/unless}}
			<div class="details-page-component">
					{{> courseMembers course}}
					{{> courseRoles roles_details}}
			</div>
			{{#if mobileViewport}}
				{{> discussion course}}
			{{/if}}
		</div>
	</div>
</template>

<template name="courseDetailsSubmenu">
		<nav>
			<ul class="nav nav-tabs">
				<li role="presentation" class='active'>
					<a href="#description" data-toggle="tab">
						<i class="fa fa-info fa-fw"></i>
						{{mf 'course.subnav.descr' 'Description'}}
					</a>
				</li>
				<li role="presentation">
					<a href="#docs" data-toggle="tab">
						<i class="fa fa-folder-open fa-fw"></i>
						{{mf 'course.subnav.docs' 'Docs'}}
					</a>
				</li>
				<li role="presentation">
					<a href="#history" data-toggle="tab">
						<i class="fa fa-history fa-fw"></i>
						{{mf 'course.subnav.history' 'History'}}
					</a>
				</li>
			</ul>
		</nav>
		<div class="tab-content">
			<div class="tab-pane active" id="description">
				{{> courseDetailsDescription}}
			</div>
			<div class="tab-pane" id="docs">
				{{> coursedocs}}
			</div>
			<div class="tab-pane" id="history">
				{{> coursehistory}}
			</div>
		</div>
</template>

<template name="courseDetailsDescription">
	<p class="course-details-description">
		{{#if editableDescription}}
			{{>editable editableDescription}}
		{{else}}
			{{{course.description}}}
		{{/if}}
	</p>
</template>


<template name="courseGroupList">
	<ul class="groups-list">
		{{#each groups}}
		<li>
			{{> groupName}}
			{{#if isOrganizer}}
				<span class="glyphicon glyphicon-bullhorn group-add"></span>
			{{/if}}
			{{#if tools}}
			<div class="btn-group">
				<button type="button" class="btn btn-default dropdown-toggle group-add"
					aria-expanded="false"
					aria-haspopup="true"
					data-toggle="dropdown">
					<span class="caret"></span>
				</button>
				<ul class="dropdown-menu">
				{{#each tools}}
					<li>{{> toolTemplate}}</li>
				{{/each}}
				</ul>
			</div>
			{{/if}}
		</li>
		{{/each}}
		{{> courseGroupAdd}}
	</ul>
</template>


<template name="courseGroupAdd">
	{{#if groupsToAdd}}
		<div class="btn-group">
			<button type="button" class="btn btn-default dropdown-toggle no-btn-style"
				aria-expanded="false"
				aria-haspopup="true"
				data-toggle="dropdown">
				<span class="glyphicon glyphicon-plus" title="{{mf 'course.group.addText' 'Add a group'}}"></span>
			</button>

			<ul class="dropdown-menu group-editor">
				{{#each groupsToAdd}}
					<li>
						<span class="group">{{> groupName}}</span>
						<button type="button" class="js-add" value="{{this}}">
							{{mf 'course.group.confirmAddButton' "Promote"}}
						</button>
					</li>
				{{/each}}
			</ul>
		</div>
	{{/if}}
</template>


<template name="courseGroupRemove">
	<li style="position: relative">
		<span class="js-expand"><span class="fa fa-remove"></span> {{mf 'course.group.remove' 'Remove'}}</span>
		{{#if expanded}}
			<div class="group-editor">
				{{#with groupId}}{{mf 'course.group.confirmRemoveText' 'Stop listing group "{NAME}" as promoters?' NAME=name}}{{/with}}
				<button type="button" class="js-remove">
					{{mf 'course.group.confirmRemoveButton' "Delist"}}
				</button>
			</div>
		{{/if}}
	</li>
</template>


<template name="courseGroupMakeOrganizer">
	<li style="position: relative">
		<span class="js-expand"><span class="glyphicon glyphicon-bullhorn"></span> {{mf 'course.group.addOrgText' "Give editing rights"}}</span>
		{{#if expanded}}
			<div class="group-editor">
				{{#with groupId}}{{mf 'course.group.confirmOrgText' 'Add group "{NAME}" as editors?' NAME=name}}{{/with}}
				{{mf 'course.group.confirmOrgNotes' "All members of the group will be able to edit the course and can create new events for it."}}
				<button type="button" class="js-makeOrganizer">
					{{mf 'course.group.confimOrgButton' "Give editing rights"}}
				</button>
			</div>
		{{/if}}
	</li>
</template>

<template name="courseGroupRemoveOrganizer">
	<li style="position: relative">
		<span class="js-expand"><span class="fa fa-remove"></span> {{mf 'course.group.removeOrgText' "Remove editing rights"}}</span>
		{{#if expanded}}
			<div class="group-editor">
				{{#with groupId}}{{mf 'course.group.confirmRemoveOrgText' 'Take away all editing rights from group "{NAME}"?' NAME=name}}{{/with}}
				<button type="button" class="js-removeOrganizer">
					{{mf 'course.group.confimRemoveOrgButton' "Take away editing rights"}}
				</button>
			</div>
		{{/if}}
	</li>
</template>
