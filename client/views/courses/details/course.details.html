<template name="coursedetails">
	<div class="coursedetails">
		<div class="coursedetails_column_left">
		{{#if edit}}
			{{> course_edit course}}
		{{else}}
			<div class="course_main {{#with course}}{{coursestate}}{{/with}}">
				{{#if isProposal}}
					<div class="courseStatus" >
						<div>
						{{mf 'course.details.tag.proposal' 'proposal'}}
						</div>
					</div>
				{{/if}}

				<div class="name">
					{{#if editableName}}{{>editable editableName}}{{else}}{{course.name}}{{/if}}
				</div>

				{{#with course}}
				<div class="course_categories">
					{{> show_categories}}
				</div>
				<div class="course-groups-list-container">
					{{> courseGroupList}}
				</div>
				{{> groupListing}}
				{{/with}}

				{{> show_course_submenu}}
				{{#with course}}
				{{#if currentUserMayEdit}}
				<div class="edit_buttons">
					<div class="btn-group" role="group" aria-label="...">
						<button type="button" class="edit" role="button">
							<span class="glyphicon glyphicon-edit"></span>
							{{mf 'course.details.edit_btn' 'Edit'}}
						</button>
						<button type="button" class="del" role="button">
							<span class="glyphicon glyphicon-remove"></span>
							{{mf 'course.details.del_btn' 'Delete'}}
						</button>
					</div>
				</div>
				{{/if}}
				{{/with}}
			</div>
			{{> report}}
		{{/if}}
			<!-- GET VIEWPORT SIZE AND ADJUST LAYOUT-->
			{{#if mobileViewport}}
				{{> course_events}}
			{{else}}
				{{> discussion course}}
			{{/if}}
		</div>
		<div class="coursedetails_column_right">
			{{#unless mobileViewport}}
				{{> course_events}}
			{{/unless}}
				<div class="courseDetails_roles_container">
						{{> roles course}}
						{{> roles_details roles_details}}
				</div>
			{{#if mobileViewport}}
				{{> discussion course}}
			{{/if}}
		</div>
	</div>
</template>




<template name="show_course_submenu">
	<div>
		<nav>
			<ul class="nav nav-tabs">
				<li role="presentation" class='active'>
					<a href="#description" data-toggle="tab">
						<span class="fa fa-info"></span>&nbsp;
						{{mf 'course.subnav.descr' 'Description'}}
					</a>
				</li>
			{{#if hasFiles}}
				<li role="presentation">
					<a href="#docs" data-toggle="tab">
						<span class="glyphicon glyphicon-folder-open"></span>&nbsp;
						{{mf 'course.subnav.docs' 'Docs'}}
					</a>
				</li>
			{{/if}}
				<li role="presentation">
					<a href="#history" data-toggle="tab">
						<span class="fa fa-history"></span>&nbsp;
						{{mf 'course.subnav.history' 'History'}}
					</a>
				</li>
			</ul>
		</nav>
		<div class="tab-content">
			<div class="tab-pane active" id="description">
				{{> course_description}}
			</div>
		{{#if hasFiles}}
			<div class="tab-pane" id="docs">
				{{> coursedocs}}
			</div>
		{{/if}}
			<div class="tab-pane" id="history">
				{{> coursehistory}}
			</div>
		</div>
	</div>
</template>

<template name="course_description">
	<div>
		<p class="course_description">
			{{#if editableDescription}}{{>editable editableDescription}}{{else}}{{{course.description}}}{{/if}}
		</p>
	</div>
</template>


<template name="courseGroupList">
	<ul class="groups-list">
		{{#each groups}}
		<li>
			{{> groupName}}
			{{#if isOrganizer}}
				<span class="glyphicon glyphicon-bullhorn"></span>
			{{/if}}
			<div class="btn-group">
				<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					<span class="caret"></span>
				</button>
				<ul class="dropdown-menu" style="display: inline">
					<li>{{> courseGroupRemove groupId=this course=..}}</li>
					<li>{{> courseGroupMakeOrganizer groupId=this course=..}}</li>
				</ul>
			</div>
		</li>
		{{/each}}
		{{> courseGroupAdd}}
	</ul>
</template>


<template name="courseGroupAdd">
	{{#if groupsToAdd}}
	<li style="position: relative">
		<span class="glyphicon glyphicon-plus js-expand" title="{{mf 'course.group.add' "Promote this course with one of my groups."}}"></span>
		{{#if expanded}}
		<div style="background-color: white; position: absolute; z-index: 2;">
			{{mf 'course.group.addText' "Add a group as promoter?"}}
			<button type="button" class="js-collapse">
				{{mf 'course.group.confirmAddClose' "Forget it"}}
			</button>
			<ul>
			{{#each groupsToAdd}}
				<li>
					{{mf 'course.group.confirmAdd' 'Promote this course with group "{NAME}"!' NAME=name}}
					<button type="button" class="js-add" value="{{this}}">
						{{mf 'course.group.confirmAddButton' "Promote"}}
					</button>
				</li>
			{{/each}}
			</ul>
		</div>
		{{/if}}
	</li>
	{{/if}}
</template>


<template name="courseGroupRemove">
	{{#if mayPromote}}
	<li style="position: relative">
		<span class="fa fa-remove js-expand" title="{{mf 'course.group.remove.confirm' 'Remove {NAME} from list of promoters' NAME=name}}">{{mf 'course.group.remove' 'Remove'}}</span>
		{{#if expanded}}
			<div style="background-color: white; position: absolute; z-index: 2;">
				{{#with groupId}}{{mf 'course.group.confirmRemoveText' 'Stop listing group "{NAME}" as promoters?' NAME=name}}{{/with}}
				<button type="button" class="js-remove">
					{{mf 'course.group.confirmRemoveButton' "Delist"}}
				</button>
				<button type="button" class="js-collapse">
					{{mf 'course.group.confirmRemoveClose' "Forget it"}}
				</button>
			</div>
		{{/if}}
	</li>
	{{/if}}
</template>


<template name="courseGroupMakeOrganizer">
	{{#if mayMakeOrganizer}}
	<li style="position: relative">
		<span class="fa fa-plus js-expand" title="{{mf 'course.group.addorg' 'Add {NAME} as editors' NAME=name}}">make editor</span>
		{{#if expanded}}
			<div style="background-color: white; position: absolute; border: 3px red; z-index: 2">
				{{#with groupId}}{{mf 'course.group.confirmOrgText' 'Add group "{NAME}" as editors?' NAME=name}}{{/with}}
				{{mf 'course.group.confirmOrgNotes' "All members of the group will be able to edit the course and can create new events for it."}}
				<button type="button" class="js-makeOrganizer">
					{{mf 'course.group.confimOrgButton' "Give editing rights"}}
				</button>
				<button type="button" class="js-collapse">
					{{mf 'course.group.confirmOrgClose' "Forget it"}}
				</button>
			</div>
		{{/if}}
	</li>
	{{/if}}
</template>
