<template name="profile">
	<div class="container-sm">
		<div class="details-page-component">
			<h1>{{mf 'login.frame.settings'}}</h1>
			<a class="profile-link" href="{{pathFor 'userprofile' _id=currentUser._id}}">
				{{mf 'login.frame.profile' 'Visit my profile'}}
			</a>
			{{#if editing}}
				<div class="details-form">
					<form class="form-horizontal profile-info-edit">
						<div class="form-group">
							<label for="editform_username" class="control-label">
								{{mf 'profile.input.username' 'Username'}}
							</label>
							<div class="control-input">
								<input class="form-control"
									id="editform_username"
									type="text"
									value="{{user.name}}"/>
								</div>
						</div>
						<div class="form-group">
							<label for="editform_email" class="control-label">
								{{mf 'profile.email' 'E-Mail'}} {{mf '_inputField.optional'}}
							</label>
							<div class="control-input">
								<input class="form-control"
									id="editform_email"
									type="text"
									value="{{user.email}}"/>
							</div>
						</div>
						<div class="form-group">
							<div class="control-btn">
								<div class="checkbox">
									<label>
										<input type="checkbox" id="privacy" {{privacyChecked}}/>
										<span class="fa fa-user-secret fa-fw" aria-hidden="true"></span>
										{{mf 'profile.toggle.highprivacy' 'High privacy'}}
										<span class="help-block">
											{{mf 'profile.toggle.highprivacy.explication' 'If enabled you can enrole anonymously to courses (experimental)'}}
										</span>
									</label>
								</div>
							</div>
						</div>
						<div class="form-actions">
							<button type="button" class="btn btn-cancel js-profile-info-cancel-btn">
								<span class="fa fa-remove fa-fw" aria-hidden="true"></span>
								{{mf '_button.cancel'}}
							</button>
							<button type="submit" class="btn btn-save profile-info-save-btn">
								<span class="fa fa-download fa-fw" aria-hidden="true"></span>
								{{mf 'profile.input.save' "Save"}}
							</button>
						</div>
					</form>
				</div>
			{{else}}
				<div class="details-body profile-info">
					<div class="details-content">
						<div class="details-info-group">
							<div class="details-info-label">
								{{mf 'profile.username' 'Username'}}
							</div>
							<div class="details-info-data">
								{{user.name}}
							</div>
						</div>
						{{#if user.have_email}}
							<div class="details-info-group">
								<div class="details-info-label">
									{{mf 'profile.email' 'E-Mail'}} {{mf '_inputField.optional'}}
								</div>
								<div class="details-info-data">
									{{user.email}}
									<small> {{verifiedEmail}} </small>
								</div>
							</div>
						{{/if}}
						{{#unless user.veryfiedEmailTrue}}
						<div class="details-info-group">
							<div class="details-info-btn">
								<button type="button" class="btn btn-success js-verify-mail-btn">
									<span class="fa fa-check-circle-o fa-lg fa-fw" aria-hidden="true"></span>
									{{mf 'profile.verifymail' 'Verify my E-Mail'}}
								</button>
							</div>
						</div>
						{{/unless}}
						<div class="details-info-group">
							<div class="details-info-label">
								{{mf 'profile.highprivacy' 'High privacy'}}
							</div>
							<div class="details-info-data">
								{{#if user.privacy}}
									<span class="fa fa-user-secret" aria-hidden="true"></span>
									{{mf 'profile.privacyOn' 'on'}}
								{{else}}
									{{mf 'profile.privacyOff' 'off'}}
								{{/if}}
							</div>
						</div>
					</div>
				</div>
				{{#if changingPass}}
				<div class="details-form">
					<form class="form-horizontal" id="changePwd">
						<div class="form-group">
							<label for="oldpassword" class="control-label">
								{{mf 'profile.input.oldPassword' 'Your current password'}}
							</label>
							<div class="control-input">
								<input type="password" class="form-control" id="oldpassword" value=""/>
							</div>
						</div>
						<div class="form-group">
							<label for="newpassword" class="control-label">
								{{mf 'profile.input.newPassword' 'New password'}}
							</label>
							<div class="control-input">
								<input type="password" class="form-control" id="newpassword" value=""/>
							</div>
						</div>
						<div class="form-group">
							<label for="newpassword_confirm" class="control-label">
								{{mf 'profile.input.repeatPassword' 'Repeat new password'}}
							</label>
							<div class="control-input">
								<input type="password" class="form-control" id="newpassword_confirm" value=""/>
							</div>
						</div>
						<div class="form-actions">
							<button type="button" class="btn btn-cancel js-change-pwd-cancel-btn">
								<span class="fa fa-remove fa-fw" aria-hidden="true"></span>
								{{mf '_button.cancel'}}
							</button>
							<button type="submit" class="btn btn-save">
								<span class="fa fa-download fa-fw" aria-hidden="true"></span>
								{{mf 'profile.changePass' 'Change my password'}}
							</button>
						</div>
					</form>
				</div>
				{{/if}}
				<div class="actions">
					{{#unless verifyDelete}}
						<button type="button" class="btn btn-delete js-profile-delete-btn"
							data-tooltip="{{mf 'profile.delete' 'Delete my account'}}">
							<span class="fa fa-trash fa-fw" aria-hidden="true"></span>
							{{mf '_button.delete'}}
						</button>
					{{/unless}}
					<button type="button" class="btn btn-edit js-profile-info-edit-btn"
						data-tooltip="{{mf 'profile.edit' 'Edit profile info'}}">
						<span class="fa fa-edit fa-fw" aria-hidden="true"></span>
						{{mf '_button.edit'}}
					</button>
					{{#unless changingPass}}
						<button type="button" class="btn btn-default js-change-pwd-btn">
							<span class="fa fa-lock fa-fw" aria-hidden="true"></span>
							{{mf 'profile.changePass' 'Change my password'}}
						</button>
					{{/unless}}
				</div>
			{{/if}}
			{{#if verifyDelete}}
				<div class="profile-delete-confirmation">
					<p>{{mf 'profile.reallydelete' 'Please confirm that you would like to delete your profile. This cannot be undone, you will have to create a new account if you want to use this site again.'}}</p>
					<div class="form-actions">
						<button type="button" class="btn btn-default js-profile-delete-cancel-btn">
							<span class="fa fa-remove fa-fw" aria-hidden="true"></span>
							{{mf '_button.cancel'}}
						</button>
						<button type="button" class="btn btn-danger js-profile-delete-confirm-btn">
							<span class="fa fa-warning fa-fw" aria-hidden="true"></span>
							{{mf 'profile.delete.confirm.button' 'Delete my user and all its profile'}}
						</button>
					</div>
				</div>
			{{/if}}
		</div>
		<div class="details-page-component">
			<a class="btn btn-success translate-link" href="/translate">
				<span class="fa fa-language fa-fw" aria-hidden="true"></span>
				{{mf 'Profile.translate_this_page' 'Help us to translate this Page'}}
			</a>
		</div>
		<div class="profile-groups-list details-page-component">
			<hr>
			<h3> {{mf 'profile.groups' 'My groups'}}</h3>
			<h5>
				{{#mf KEY='profile.groupMembership' NUM_GROUPS=groupCount}}
				You are {NUM_GROUPS, plural,
				=0 {not member of any group}
				=1 {member of the group:}
				other {member of # groups:}}
				{{/mf}}
			</h5>
			<ul class="groups">
				{{#each user.groups}}
					{{#with this._id}}
						<li>
							{{> groupNameFull}}
						</li>
					{{/with}}
				{{/each}}
			</ul>
			<a class="btn btn-add"
				href="{{pathFor 'groupDetails' _id='create'}}">
				<span class="fa fa-plus fa-fw" aria-hidden="true"></span>
				{{mf 'profile.createNewGroup.button' 'Create a new group'}}
			</a>
		</div>
		<div class="details-page-component">
			<div class="course-list">
				{{#each courses}}
					{{> course}}
				{{/each}}
			</div>
		</div>
	</div>
</template>
