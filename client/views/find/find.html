<template name="findWrap">
	<div class="find">
		<h1 class="find-heading">{{mf 'find.WhatLearn?' 'What do you want to learn?'}}</h1>
		{{> find}}
	</div> <!-- .find -->
</template>

<template name="find">
	<div class="search">
		<div class="js-search-field">
			<div class="input-group">
				<input
					class="js-search-input"
					type="text"
					id="find"
					value="{{search}}"
					placeholder="{{mf 'find.search_placeholder' 'Everything'}}"
				/>
				<span class="input-group-btn">
					<button class="js-find-btn" type="button">
						{{mf 'find.search_go' 'Go!'}}
					</button>
					{{#unless isMobile}}
						{{#if showingFilters}}
							<button class="js-toggle-filter remove-filter" type="button">
								<span class="glyphicon glyphicon-remove"></span>
								{{mf 'find.hideFilters' 'Remove filters'}}
							</button>
						{{else}}
							<button class="js-toggle-filter" type="button">
								<span class="glyphicon glyphicon-filter"></span>
								{{mf 'find.showFilters' 'Filter'}}
							</button>
						{{/if}}
					{{/unless}}
				</span>
			</div> <!-- .input-group -->
		</div> <!-- .search -->
		{{#if isMobile}}
			{{#if showingFilters}}
				<button class="js-toggle-filter remove-filter" type="button">
					<span class="glyphicon glyphicon-remove"></span>
					{{mf 'find.hideFilters' 'Remove filters'}}
				</button>
			{{else}}
				<button class="js-toggle-filter" type="button">
					<span class="glyphicon glyphicon-filter"></span>
					{{mf 'find.showFilters' 'Filter'}}
				</button>
			{{/if}}
		{{/if}}
		<div class="filter" style="{{#if showingFilters}}display:block;{{else}}display:none;{{/if}}">
			<div class="filter-header">
				<h4 class="filter-heading">
					<span class="glyphicon glyphicon-filter"></span>
					{{mf 'find.search_filter.title' 'Filter search'}}
				</h4>
			</div> <!-- .filter-header -->
			<div class="filter-course-properties">
				<div class="btn-group-vertical" data-toggle="buttons">
					<label class="js-toggle-property-filter js-filter-upcoming-events btn">
						<input
							type="checkbox"
							id="hasUpcomingEvent"
							name="hasUpcomingEvent"
							autocomplete="off"
							{{toggleChecked 'upcomingEvent'}}
						/>
						{{#if toggleChecked 'upcomingEvent'}}
							<div class="eventcaption_upcoming">
								<div class="eventcaption_upcoming_box">
									<div class="eventcaption_upcoming_text first-line"></div>
									<div class="eventcaption_upcoming_text second-line"></div>
									<div class="eventcaption_upcoming_text third-line"></div>
								</div> <!-- .eventcaption_upcoming_box -->
							</div> <!-- .eventcaption_upcoming -->
						{{/if}}
						{{#unless toggleChecked 'upcomingEvent'}}
							<span class="glyphicon glyphicon-calendar"></span>
						{{/unless}}
						&nbsp;
						{{mf 'find.with_upcoming_events' 'With upcoming events'}}
						&nbsp;
						{{#if toggleChecked 'upcomingEvent'}}
							<span class="checkmark"></span>
						{{/if}}
					</label>
					<label class="js-toggle-property-filter js-filter-needs-host btn">
						<input
							type="checkbox"
							id="needsHost"
							name="needsHost"
							autocomplete="off"
							{{toggleChecked 'needsHost'}}
						/>
						<span class="glyphicon glyphicon-home {{#if toggleChecked 'needsHost'}}active-property-filter-icon{{/if}}"></span>
						&nbsp;
						{{mf 'find.needsHost' 'Looking for a host'}}
						&nbsp;
						{{#if toggleChecked 'needsHost'}}
							<span class="checkmark"></span>
						{{/if}}
					</label>
					<label class="js-toggle-property-filter js-filter-needs-mentor btn">
						<input
							type="checkbox"
							id="needsMentor"
							name="needsMentor"
							autocomplete="off"
							{{toggleChecked 'needsMentor'}}
						/>
						<span class="fa fa-graduation-cap {{#if toggleChecked 'needsMentor'}}active-property-filter-icon{{/if}}"></span>
						&nbsp;
						{{mf 'find.needsMentor' 'Looking for a mentor'}}
						&nbsp;
						{{#if toggleChecked 'needsMentor'}}
							<span class="checkmark"></span>
						{{/if}}
					</label>
				</div> <!-- .btn-group-vertical -->
			</div> <!-- .filter-course-properties -->
			<div class="filter-categories">
				<h4 class="filter-categories-heading">
					{{mf 'find.filter.categories' 'Categories'}}
				</h4>
				{{#if categories}}
					<ul class="filter-selected-categories">
					{{#each categories}}
						<li>
							<a class="js-category" href="#">{{categoryName}}</a>
							<span
								class="remove-btn js-remove-category-btn"
								title="{{mf 'find.filter.removeCategory' 'Remove category {CATEGORYNAME} from filter' CATEGORYNAME=categoryName}}">
							</span>
						</li>
					{{/each}}
					</ul>
				{{/if}}
				<div class="dropdown filter-categories-select">
					<input
						class="js-search-categories"
						placeholder="{{mf 'find.searchCategories.placeholder' 'Add category'}}"
						type="text"
					/>
					<button
						class="dropdown-toggle"
						data-toggle="dropdown"
						role="button"
						aria-expanded="false">
						<span class="caret"></span>
					</button>
					<ul class="dropdown-menu filter-categories-dropdown" role="menu">
						{{#if availableCategories}}
							{{#each availableCategories}}
								<li class="{{this}}">
									<a class="js-category {{#if availableSubcategories this}}main-category{{/if}}" href="#">
										{{categoryName}}
									</a>
									{{#if availableSubcategories this}}
										<small
											class="js-toggle-subcategories {{this}}"
											title="{{mf 'find.showSubcategories.title' 'Show/Hide subcategories'}}">
											<span class="glyphicon glyphicon-plus"></span>
										</small>
									{{/if}}
								</li>
								{{#each availableSubcategories this}}
									<li class="js-sub-category {{..}}">
										<a class="js-category" href="#">{{categoryName}}</a>
									</li>
								{{/each}}
							{{/each}}
						{{else}}
							<span class="filter-no-categories-found">
								<span class="fa fa-exclamation"></span>
								{{mf 'find.filter-no-categories-found' 'No categories found.'}}
							</span>
						{{/if}}
					</ul>
				</div> <!-- .filter-categories-select -->
			</div> <!-- .filter-categories -->
		</div> <!-- .filter -->
	</div> <!-- .search -->
	<div class="courselist_results">
		{{#unless ready}}
			{{> loadingPage}}
		{{else}}
			{{#each results}}
				{{> course}}
			{{else}}
				<div class="no-courses-found">
				{{mf 'find.no-courses-found' 'No Courses found.'}}
				{{#unless allRegions}}
					<br>
					<button class="js-all-regions-btn">
						<span class="fa fa-dot-circle-o"></span>
						{{mf 'find.searchAllRegions' 'Search in all regions'}}
					</button>
					<br>
				{{/unless}}
				{{#if proposeNewBlurb}}
					{{mf 'find.propose_new_course?' 'Why not propose a new one for "{TERM}"?' TERM=this.query.search}}
				{{/if}}
				</div> <!-- .no-courses-found -->
			{{/each}}
		{{/unless}}
	</div> <!-- .courselist_results -->
	{{#if eventResults.count}}
		<div class="courselist_results">
			<hr>
			<h3>
			{{#if results.count}}
				{{#mf KEY='find.events.aditional_results' EVENTS=eventResults.count}}
					{EVENTS, plural,
						one {In addition, we found this event}
						other {In addition, we found these # events}
					}
				{{/mf}}
			{{else}}
				{{#mf KEY='find.events.results_if_no_courses' EVENTS=eventResults.count}}
					{EVENTS, plural,
						one {All we found is this one event}
						other {Yet # Events have been found}
					}
				{{/mf}}
			{{/if}}
			</h3><br />
			{{#each eventResults}}
					{{> small_event}}
			{{/each}}
		</div> <!-- .courselist_results -->
	{{/if}}
	{{> course_edit newCourse}}
</template>
