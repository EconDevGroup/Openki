<template name="find">
<div class="find">
	<h1>{{mf 'find.WhatLearn?' 'What do you want to learn?'}}</h1>
	<div class="search">
		<div class="input-group">
			<input type="text" class="searchInput" value="{{search}}" placeholder="{{mf 'find.search_placeholder' 'Everything'}}">
			<span class="input-group-btn">
				<button class="filter-toggle-btn" type="button">
					<span class="glyphicon glyphicon-filter"></span>
					{{mf 'find.search_filter_toggle' 'Filter'}}
				</button>
			</span>
			<span class="input-group-btn">
				<button class="find-btn" type="button">
					{{mf 'find.search_go' 'Go!'}}
				</button>
			</span>
		</div>
		<div class="search_filter" style="display:none">
			<div class="search_filter_header">
				<h4>
					<span class="glyphicon glyphicon-filter"></span>
					{{mf 'find.search_filter.title' 'Filter search'}}
				</h4>
			</div>
			<div class="search_events">
				<h4>Events</h4>
				<div class="checkbox">
					<label>
						<input type="checkbox" id="hasUpcomingEvent" name="hasUpcomingEvent">
						<span class="fa {{#if hasUpcomingEventsChecked}}fa-toggle-on{{else}}fa-toggle-off{{/if}}"></span>
						&nbsp;
						{{mf 'find.only with events_checkbox' 'Only with events'}}
					</label>
				</div>
			</div>
			<div class="filter_categories">
				<h4>{{mf 'find.filter.categories' 'Categories'}}</h4>
				<div class="category_select">
					<div class="dropdown">
						<a class="dropdown-toggle" data-toggle="dropdown">
							{{mf 'find.filter.select_categories' 'Select categories'}}
							<span class="caret"></span>
						</a>
						<ul class="dropdown-menu" role="menu">
							{{#each availableCategories}}
							<li class="{{this}}">
								<a class="category parent">
									{{categoryName}}
									{{#if availableSubcategories this}}
									&nbsp;
									<span class="fa fa-level-down show_subcategories {{this}}" title="{{mf 'find.filter.show_subcategories' 'Show subcategories'}}"
									></span>
									{{/if}}
								</a>
							</li>
							{{#each availableSubcategories this}}
							<li class="subcategory {{..}}">
								<a class="category sub">
									{{categoryName}}
								</a>
							</li>
							{{/each}}
							{{/each}}
						</ul>
					</div>
				</div>
				{{#if categories}}
				<h5>{{mf 'find.filter.categories.selected' 'Selected {COUNT, plural, one {category} other {# categories}}' COUNT=categories.length}}</h5>
				<ul class="selected_categories">
				{{#each categories}}
					<li>
						<span class="category">{{categoryName}}</span>
						<span class="glyphicon glyphicon-remove removeCategoryFilter" title="{{mf 'find.filter.removeCategory' 'Remove category {CATEGORYNAME} from filter' CATEGORYNAME=categoryName}}"></span>
					</li>
				{{/each}}
				</ul>
				{{else}}
				<span class="categories_explanation">
					{{mf 'find.filter.categories.explanation' '... or click on a category to add it to the filter.'}}
				</span>
				{{/if}}
			</div>
			{{#with group}}
			{{#if this}}
			<div class="filter_group">
				<h5>
					{{mf 'find.filter.group' 'Showing courses in group {NAME}' NAME=name}}
					<span class="glyphicon glyphicon-remove removeGroupFilter" title="{{mf 'find.filter.removeCategory' 'Remove filter'}}"></span>
				</h5>
			</div>
			{{/if}}
			{{/with}}
		</div>
	</div>
	<div class="courselist_results">
		{{#each results}}
			{{> course}}
		{{else}}
			{{#if ready}}{{mf 'find.no_courses_found.propose_new_course?' 'No Courses found. Do you want to propose this one?'}}{{/if}}
		{{/each}}
		{{#unless ready}}
			<div style="padding-bottom: 100px">
				{{> loading}}
			</div>
		{{/unless}}
	</div>
	{{#if eventResults.count}}
	<div class="courselist_results">
		<hr>
		<h3>
		{{#if results.count}}
			{{#mf KEY='find.events.aditional_results' EVENTS=eventResults.count}}
				 {EVENTS, plural,
					one {In addition, we found this event}
					other {In addition, we found these # events}
				}
			{{/mf}}
		{{else}}
			{{#mf KEY='find.events.results_if_no_courses' EVENTS=eventResults.count}}
				{EVENTS, plural,
					one {All we found is this one event}
					other {Yet # Events have been found}
				}
			{{/mf}}
		{{/if}}
		</h3><br />
		{{#each eventResults}}
		<div class="event_results">
			{{>course_event event=this}}
		</div>
		{{/each}}
	</div>
	{{/if}}
	{{> course_edit newCourse}}
</div>
</template>
