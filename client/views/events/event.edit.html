<template name="eventEdit">
<form>
	<div class="course_event_edit col-sm-12">
		<div class="col-sm-12">
			<h2>{{#if _id}}{{mf 'course.event.edit.edit' 'Edit event'}}{{else}}{{mf 'course.event.edit.add' 'Add event'}}{{/if}}</h2>
			<h4>{{mf 'course.event.edit.title' 'Event title:'}}</h4>
			<input type="text" class="form-control" id="edit_event_title" size="30" placeholder="{{mf 'event.title.placeholder' 'Put a catchy title here'}}" value="{{this.title}}" name="_" />
		</div>
		<div class="col-sm-12 no-padding">
			<div class="col-sm-4">
				<h4>{{mf 'course.event.edit.date_start' 'Date'}}</h4>
				<div class="input-group">
					<span class="input-group-addon">
						<span class="glyphicon glyphicon-calendar"></span>
					</span>
					<input type="date" id="edit_event_startdate" class="form-control" value="{{isoDateFormat start}}" size="8" {{disableForPast}}>
				</div>
			</div>
			<div class="col-sm-4">
				<h4>{{mf 'course.event.edit.time_start' 'Time start'}}</h4>
				<div class="input-group">
					<span class="input-group-addon">
						<span class="glyphicon glyphicon-time"></span>
					</span>
					<input type="time" id="edit_event_starttime" class="form-control" value="{{timeformat start}}" size="5" {{disableForPast}}>
				</div>
			</div>
			<div class="show_time_end col-sm-4">
				<h4>{{mf 'course.event.edit.time_end' 'Time end'}} <small class="toggle_duration" > &nbsp;&nbsp;{{mf 'course.event.edit.swich_duration' 'switch to duration'}} </small></h4>
				<div class="input-group">
					<span class="input-group-addon">
						<span class="glyphicon glyphicon-time"></span>
					</span>
					<input type="time" id="edit_event_endtime" class="form-control" value="{{timeformat end}}" size="5">
				</div>
			</div>
			<div style="display:none" class="col-sm-4 show_duration">
				<h4>{{mf 'course.event.edit.duration' 'Duration (in minutes)'}} <small class="toggle_duration" > &nbsp;&nbsp; {{mf 'course.event.edit.switch_time_end' 'switch to end time'}} </small></h4>
				<div class="input-group">
					<span class="input-group-addon">
						<span class="glyphicon glyphicon-time"></span>
					</span>
					<input type="number" id="edit_event_duration" class="form-control" value="{{timeformat Duration}}" size="5">
				</div>
			</div>
		</div>
		<div class="col-sm-12">
			<div class="col-xs-12 no-padding-left">
				<h4>{{mf 'course.event.edit.desc' 'Description:'}}</h4>
				<div class="input-group">
					<span class="input-group-addon">
						<span class="glyphicon glyphicon-info-sign"></span>
					</span>
					{{>eventDescritpionEdit description}}
				</div>
			</div>
		</div>
		<div class="col-xs-12 col-sm-6 ">
			<h4>{{mf 'course.event.edit.files' 'Files: (optional)'}}</h4>
			<div class="input-group">
				<span class="input-group-addon">
					<span class="glyphicon glyphicon-file"></span>
				</span>
				<div id="edit_event_description" style="min-height: 10ex; position:relative">
					<div style="float:left;width:70%;">
						<input type="file" name="â€¦" class="eventFileInput" id="edit_files">
						<button style="display:none" type="button" class="eventFileUpload" role="button">
							<span class="glyphicon glyphicon-edit"></span>
							Start Upload
						</button>
					</div>
					<div style="float:left;width:20%;">
						<table class="file-list">
							{{#each files}}
							{{> eventAttachmentsEdit}}
							{{/each}}
						</table>
					</div>
				</div>
			</div>
		</div>

		<div class="col-sm-12 no-padding">

		{{#if showRegionSelection}}
			<div class="col-xs-12 col-sm-4">
				<h4>{{mf 'course.edit.region' 'Region:'}}</h4>
				<div class="styled-select">
					<select name='region' class="region_select">
						<option value='' class="select_default">{{mf 'course.edit.pls_select' 'Please select'}}</option>
						{{#each regions}}
						<option value='{{_id}}' selected="{{#if currentRegion this}}selected{{/if}}">{{name}}</option>
						{{/each}}
					</select>
					<span class="caret"></span>
				</div>
			</div>
		{{/if}}

			<div class="col-xs-12 col-sm-6">
				<h4>{{mf 'course.event.edit.location' 'Location:'}}</h4>
				<div id="editform_location" class="input-group">
					<span class="input-group-addon">
						<span class="glyphicon glyphicon-home"></span>
					</span>
			{{#if locationStateShow}}
					<div style="float: right"><button type="button" class="-locationChange">{{mf 'event.edit.locationChange' "Change location"}}</button></div>
					{{location.name}}
					{{#if location.address}}<div style="font-size: small">{{location.address}}</div>{{/if}}
			{{else}}
					<input type="text" class="form-control -locationName" size="40" value="{{location.name}}" placeholder="{{mf 'event.edit.locationNamePlaceholder' "Name of the location"}}"/>
				{{#if locationStateAdd}}
					<input type="text" class="form-control -locationAddress" size="40" value="{{location.address}}" placeholder="{{mf 'event.edit.locationAddressPlaceholder' "Address of the location"}}"/>
					<button type="button" class="-addressSearch"><span class="glyphicon glyphicon-search"></span></button>
				{{else}}
						<button type="button" class="-locationAdd">{{mf 'event.edit.LocationAdd' "Add new address"}}</button>
					{{#if locationIsSet}}<button type="button" class="-locationReset">{{mf 'event.edit.locationReset' "Never mind"}}</button>{{/if}}
				{{/if}}
					<ul>
					{{#each locationCandidates}}
						<li class="-locationCandidate">
							{{name}}
							<div style="font-size: small">{{address}}</div>
						</li>
					{{/each}}
					</ul>
			{{/if}}
				</div>
				<h4>{{mf 'course.event.edit.room' 'Room: (optional)'}}</h4>
				<div id="editform_room" name="editform_room" class="input-group">
					<span class="input-group-addon">
						<span class="fa fa-map-signs"></span>
					</span>
					<input type="text" id="edit_event_room" class="form-control" size="40" value="{{room}}"/>
				</div>
			</div>
			<div class="col-xs-12 col-sm-6">
				{{>map markers=eventMarkers height=300 allowPlacing=allowPlacing}}
			</div>
		</div>

		<div class="col-sm-12 no-padding event_edit_buttons">
			<div class="col-xs-12 col-sm-5">
				<button type="submit" class="saveEditEvent btn btn-primary form-control">
					<span class="glyphicon glyphicon-save"></span>
					{{mf 'course.event.edit.save_btn' 'Save'}}
				</button>
			</div>
			<div class="col-xs-12 col-sm-2">
				{{#if affectedReplicaCount}}
					<label>
						<input type="checkbox" name="updateReplicas">
						{{mf 'event.edit.updateReplicas' "Update {COUNT, plural, one {copy} other {# copies}}" COUNT=affectedReplicaCount}}
					</label>
					{{mf 'event.edit.updateReplicas.times' "time-changes will not be updated in {COUNT, plural, one {copy} other {copies}}." COUNT=affectedReplicaCount}}
				{{/if}}
			</div>
			<div class="col-xs-12 col-sm-5">
				<button type="button" class="cancelEditEvent btn btn-default form-control">
					<span class="glyphicon glyphicon-remove"></span>
					{{mf 'course.event.edit.cancel_btn' 'Cancel'}}
				</button>
			</div>
		</div>
		<div style="clear:both"></div>
	</div>
</form>
</template>

<template name="eventDescritpionEdit">
	<div id="edit_event_description" style="min-height: 10ex" data-placeholder="{{mf 'event.description.placeholder' 'Describe your event as accurately as possible. This helps people to know how to prepare and what to expect from this meeting (eg. level, prerequisites, activities, teaching methods, what to bring, et cetera)'}}">{{{this}}}</div>
</template>

<template name="eventAttachmentsEdit">
<tr id="row-{{_id}}">
	<td style="padding-right:5px;">
		<a href="{{file}}" target="_blank">{{filename}}</a>
	</td>
	<td>
		<button role="button" class="fileDelete close" type="button">
			<span class="glyphicon glyphicon-remove"></span>
		</button>
	</td>
</tr>
</template>
