#!/bin/sh
set -e

fail() {
	echo "$1"
	exit 1
}

usage() {
	echo "Usage: $0 <hostname>"
	fail "$1"
}


host=$1
[ -n "$host" ] || usage "please add hostname argument."

URL=$(meteor mongo --url "$host")
echo "DB URL is: $URL"

CMD=$(echo "$URL" | sed 's_mongodb://\([a-z0-9\-]*\):\([a-f0-9\-]*\)@\(.*\)/\(.*\)_mongodump --username \1 --password \2 --host \3 --db \4_')
echo "Running $CMD"
$CMD
